<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAMPA - Sistema de An√°lise e Monitoramento</title>
    
    <style>
        /* Estilos Globais */
        body, html {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: #fff;
            height: 100%;
        }

        /* Layout Principal */
        .app-layout {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        .main-header {
            text-align: left;
            padding: 10px 20px;
            border-bottom: 1px solid #ddd;
            background-color: #fafafa;
            flex-shrink: 0; /* Impede que o header encolha */
        }
        .main-header h1 {
            margin: 0;
            font-size: 16px;
            font-weight: 500;
            color: #333;
        }
        .content-wrapper {
            flex-grow: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column; /* Organiza as p√°ginas verticalmente */
        }

        /* ‚úÖ ESTILO ADICIONADO: Cont√™iner das P√°ginas */
        .page {
            display: none; /* Esconde todas as p√°ginas por padr√£o */
            height: 100%;
            width: 100%;
        }
        .page.active {
            display: flex; /* Mostra apenas a p√°gina ativa */
        }

        /* ‚úÖ ESTILO MODIFICADO: Centraliza o Kanban */
        .board-container {
            display: flex;
            padding: 20px;
            overflow-x: auto;
            background-color: #ffffff;
            width: 100%;
            align-items: flex-start;
            justify-content: center; /* Centraliza as colunas */
        }

        /* Coluna do Kanban */
        .kanban-column {
            flex: 0 0 240px;
            display: flex;
            flex-direction: column;
            margin: 0 8px;
            padding-top: 50px;
            position: relative;
        }
        
        /* ... (restante do seu CSS original, sem altera√ß√µes) ... */
        .status-message{width:100%;text-align:center;padding:40px;font-size:18px;color:#666}.error{color:#d9534f}.column-header-wrapper{position:relative;display:flex;flex-direction:column;align-items:center;margin-bottom:20px}.column-connector-line{position:absolute;top:25px;left:-50%;width:100%;height:2px;background-color:#ccc;z-index:1}.kanban-column:first-child .column-connector-line{display:none}.column-header{text-align:center;position:relative;z-index:2;display:flex;flex-direction:column;align-items:center;width:100%}.header-icon{width:50px;height:50px;border-radius:50%;display:flex;justify-content:center;align-items:center;margin-bottom:10px;box-shadow:0 2px 4px rgba(0,0,0,.1)}.header-icon span{font-size:24px;color:#fff}.column-header h3{font-size:15px;font-weight:700;color:#333;margin:0}.column-header h4{font-size:12px;color:#555;font-weight:400;margin-top:4px}.card-list{list-style-type:none;padding:0;margin:0;flex-grow:1;overflow-y:auto;min-height:100px}.card-list li{margin-bottom:10px}.kanban-card{background-color:#fffbef;border:1px solid #e0e0e0;border-radius:3px;padding:8px 12px;cursor:grab;box-shadow:0 1px 2px rgba(0,0,0,.1);font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;display:flex;flex-direction:column;gap:8px}.card-row{display:flex;justify-content:space-between;align-items:center;width:100%}.card-id{font-weight:700;font-size:14px;color:#333}.card-days{font-size:13px;color:#555;display:flex;align-items:center}.arrow-icon{font-size:8px;margin-right:5px;color:#888}.title-row{align-items:flex-end}.card-title{font-size:14px;color:#333;margin:0;line-height:1.2;flex-grow:1}.footer-row{font-size:12px;color:#777}.status-tag{background-color:#f0f0f0;border:1px solid #ccc;padding:1px 4px;border-radius:3px}.bottom-navbar{width:100%;background-color:#f8f9fa;border-top:1px solid #dee2e6;padding:5px 0;position:fixed;bottom:0;left:0;z-index:1000;flex-shrink:0}.bottom-navbar ul{display:flex;justify-content:center;align-items:center;list-style:none;margin:0;padding:0}.bottom-navbar li a{padding:10px 20px;text-decoration:none;color:#495057;font-weight:500;font-size:14px;border-radius:4px;cursor:pointer}.bottom-navbar li a.active{background-color:#e9ecef;color:#0056b3}
    </style>
</head>
<body>
    <div id="app" class="app-layout">
        <header class="main-header">
            <h1>SAMPA - Sistema de An√°lise e Monitoramento do Planejamento de Aquisi√ß√µes</h1>
        </header>
        
        <main class="content-wrapper">
            <div id="page-andamentos" class="page active">
                <div id="kanban-board" class="board-container">
                    <div class="status-message">Carregando dados...</div>
                </div>
            </div>

            <div id="page-riscos" class="page">
                <div class="status-message"><h1>P√°gina de Riscos</h1><p>Esta tela est√° em desenvolvimento.</p></div>
            </div>

            <div id="page-atividades" class="page">
                <div class="status-message"><h1>P√°gina de Atividades</h1><p>Esta tela est√° em desenvolvimento.</p></div>
            </div>

            </main>
        
        <nav class="bottom-navbar">
            <ul>
                <li><a data-target="page-andamentos" class="active">Andamentos</a></li>
                <li><a data-target="page-atividades">Atividades</a></li>
                <li><a href="#">Contratos</a></li>
                <li><a href="#">Gest√£o</a></li>
                <li><a data-target="page-riscos">Riscos</a></li>
            </ul>
        </nav>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const API_URL = "https://script.google.com/macros/s/AKfycbw0V2iYm5m1Uw_1sX39rtq5CgG9XFAZwsYvV6pdnb-346KtOE6D_ndSikqbN0GZjioe/exec";
            const boardElement = document.getElementById('kanban-board');

            // ‚úÖ L√ìGICA DE ROTEAMENTO ADICIONADA
            const navLinks = document.querySelectorAll('.bottom-navbar a[data-target]');
            const pages = document.querySelectorAll('.page');

            function showPage(targetId) {
                // Esconde todas as p√°ginas
                pages.forEach(page => page.classList.remove('active'));
                // Mostra a p√°gina alvo
                const targetPage = document.getElementById(targetId);
                if (targetPage) {
                    targetPage.classList.add('active');
                }
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault(); // Impede que o link navegue para '#'
                    
                    // Atualiza a classe 'active' nos links
                    navLinks.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                    
                    // Mostra a p√°gina correspondente
                    const targetId = link.getAttribute('data-target');
                    showPage(targetId);
                });
            });

            // ... (resto do seu script original, sem altera√ß√µes) ...
            const faseParaColunaId={"Gest√£o do Contrato":"cca_gestor","Sele√ß√£o de Fornecedor":"licitacao","Planejamento da Contrata√ß√£o":"contratacoes"};function formatarProcessoId(e){if(!e)return null;const t=String(e).substring(6);return parseInt(t,10)}function processarDadosDaApi(e){const t={cca_gestor:{id:"cca_gestor",title:"CCA / gestor",subtitle:"Gest√£o do Contrato",icon:"üìã",color:"#4C6EF5",cards:[]},licitacao:{id:"licitacao",title:"Licita√ß√£o",subtitle:"Sele√ß√£o Fornecedor",icon:"üèÜ",color:"#FD7E14",cards:[]},contratacoes:{id:"contratacoes",title:"Contrata√ß√µes",subtitle:"Planejamento",icon:"‚úçÔ∏è",color:"#845EF7",cards:[]}};if(!Array.isArray(e))return console.error("Os dados recebidos da API n√£o s√£o um array:",e),[];return e.forEach(e=>{const o=e["Fase Atual"],a=faseParaColunaId[o];if(a&&t[a]){const o=e["Data Contrato"],n=o?new Date(o).toLocaleDateString("pt-BR"):"N/D";t[a].cards.push({id:formatarProcessoId(e["Processo Administrativo"]),title:e["Andamento - Objeto resumido"],days:e["Dura√ß√£o (dias)"],dateInfo:n,statusTag:e.Status})}}),Object.values(t)}function renderizarPainel(e){if(boardElement.innerHTML="",0===e.length)return void(boardElement.innerHTML='<div class="status-message">Nenhum dado encontrado para exibir.</div>');e.forEach(e=>{const t=document.createElement("div");t.className="kanban-column",t.innerHTML=`\n                        <div class="column-header-wrapper">\n                            <div class="column-connector-line"></div>\n                            <div class="column-header">\n                                <div class="header-icon" style="background-color: ${e.color};">\n                                    <span>${e.icon}</span>\n                                </div>\n                                <h3>${e.title}</h3>\n                                <h4>${e.subtitle}</h4>\n                            </div>\n                        </div>\n                        <ul class="card-list" id="column-${e.id}"></ul>\n                    `,boardElement.appendChild(t);const o=t.querySelector(".card-list");e.cards.forEach(e=>{const t=document.createElement("li");t.innerHTML=`\n                            <div class="kanban-card" data-card-id="${e.id}">\n                                <div class="card-row">\n                                    <span class="card-id">${e.id}</span>\n                                    <span class="card-days">\n                                        <span class="arrow-icon">‚ñ∂</span>\n                                        ${e.days} d\n                                    </span>\n                                </div>\n                                <div class="card-row title-row">\n                                    <p class="card-title">${e.title}</p>\n                                </div>\n                                <div class="card-row footer-row">\n                                    <span class="card-date-info">${e.dateInfo}</span>\n                                    <span class="status-tag">${e.statusTag}</span>\n                                </div>\n                            </div>\n                        `,o.appendChild(t)})});const t=document.querySelectorAll(".card-list");t.forEach(e=>{new Sortable(e,{group:"kanban",animation:150})})}async function fetchBoardData(){try{const e=await fetch(API_URL);if(!e.ok)throw new Error(`Erro na rede: ${e.statusText}`);const t=await e.json(),o=processarDadosDaApi(t);renderizarPainel(o)}catch(e){console.error("Falha ao buscar ou processar dados da API:",e),boardElement.innerHTML='<div class="status-message error">N√£o foi poss√≠vel carregar os dados do painel.</div>'}}fetchBoardData()
        });
    </script>
</body>
</html>